{"version":3,"file":"ggbt.min.js","sources":["../src/ggbt.js"],"sourcesContent":["\r\n/*eslint linebreak-style:0 -- ['error', 'windows','unix']*/\r\n/* eslint-disable no-undef */\r\n/**\r\n * Javascript Controller to embed GGBApplet\r\n *\r\n * This class provides all the functionality for the new assign module.\r\n *\r\n * @author         Christoph Stadlbauer <christoph.stadlbauer@geogebra.org>\r\n * @copyright  (c) International GeoGebra Institute 2018\r\n * @license        http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n// alert(\"hello ggbt\");\r\nvar GGBAppletstr;\r\nvar codebase;\r\n               if (document.getElementById('id_isurlggb')!== null) {\r\n                    if (document.getElementById('id_isurlggb').checked) {\r\n                     GGBAppletcode = document.getElementById('id_urlggb').value;\r\n                      var parts=GGBAppletcode.split(\",\");\r\n                  var rooturl=parts[0];\r\n                  var appl=parts[1];\r\n                  var base=parts[2];\r\n                  GGBAppletstr = rooturl+appl ;\r\n                  codebase = rooturl+base;\r\n                     }else {\r\n                     GGBAppletstr = 'https://www.geogebra.org/apps/deployggb.js';\r\n                     codebase=\"\";}\r\n                }\r\n define(['jquery', GGBAppletstr], function ($, GGBApplet) {\r\n// define(['jquery', 'https://www.geogebra.org/apps/deployggb.js'], function ($, GGBApplet) {\r\n //define(['jquery'], function ($) {\r\n    /**\r\n     * Created by Christoph on 25.08.19.\r\n     */\r\n     //var script = document.createElement('script');\r\n     //script.src = 'https://www.geogebra.org/apps/deployggb.js';\r\n     //document.getElementsByTagName('head')[0].appendChild(script);\r\n    return {\r\n\r\n\r\n        init: function() {\r\n\r\n        //debugcode();//\r\n            window.GGBT = this;\r\n            window.ggbAppletOnLoad = function() {\r\n            debugcode();\r\n                $('input[name=\"ggbparameters\"]').val(JSON.stringify(window.applet1.getParameters()));\r\n                $('input[name=\"ggbviews\"]').val(JSON.stringify(window.applet1.getViews()));\r\n                $('input[name=\"ggbcodebaseversion\"]').val(window.applet1.getHTML5CodebaseVersion());\r\n\r\n                if (typeof (this.ggbcheckb) == \"undefined\") {\r\n                    var applet = document.ggbApplet;\r\n                    $('input[name=\"ggbxml\"]').val(applet.getXML());\r\n\r\n                    var randomizedvar = document.getElementById('id_randomizedvar');\r\n                    if (!randomizedvar.value) {\r\n                        window.GGBT.getrandvars();\r\n                    }\r\n\r\n                    var i = 0;\r\n                    var answer = $('#id_answer_' + i);\r\n                    while (answer[0] !== undefined) {\r\n                        if (answer.val()) {\r\n                            answer.on('change focus', function(e) {\r\n                                e.preventDefault();\r\n                                window.GGBT.update_feedback($(e.target));\r\n                            });\r\n                            window.GGBT.update_feedback(answer);\r\n                        }\r\n                        answer = $('#id_answer_' + ++i);\r\n                    }\r\n                    document.querySelector('article').onkeypress = window.GGBT.checkEnter;\r\n                }\r\n                if (window.GGBT.usefile.checked) {\r\n                    document.getElementById('applet_container1').style.display = \"block\";\r\n                    document.getElementById('applet_options').style.display = \"flex\";\r\n                }\r\n            };\r\n\r\n            if ($('#applet_parameters')[0] !== undefined) {\r\n                this.ggbDataset = $('#applet_parameters')[0].dataset;\r\n                try {\r\n                     this.parameters = JSON.parse(this.ggbDataset.parameters);\r\n                     }\r\n                catch(err) {\r\n                   alert(\"Error parsing JSON \"+err.message);\r\n                }\r\n                this.parameters = JSON.parse(this.ggbDataset.parameters);\r\n                this.views = this.ggbDataset.views;\r\n                 //alert(\"hello custom ggb 3\");\r\n        debugcode();\r\n               // if (document.getElementById('id_isurlggb').checked) {\r\n                     //GGBApplet = document.getElementById('id_urlggb').value;\r\n               //     }\r\n                //window.applet1 = new GGBApplet(this.parameters, this.views, true);\r\n                window.applet1 = new GGBApplet(this.parameters, true);\r\n                if(!(codebase===\"\")){\r\n                 window.applet1.setHTML5Codebase(codebase);\r\n                 }\r\n                this.lang = this.ggbDataset.lang;\r\n            }\r\n        //debugcode();\r\n\r\n            //$('#id_stoapplet').on('click', this.handleStoreGGB);\r\n            $('#id_loadapplet').on('click', function(e) {\r\n            debugcode();\r\n                e.preventDefault();\r\n                var httpurl = $('#id_ggbturl').val();\r\n                var id = httpurl.split(\"/\").pop();\r\n                if(!httpurl.startsWith('http')){\r\n                 if (id.indexOf(\"m\") == 0){\r\n                    if (window.GGBT.isNumber(id.substr(1)) || (!window.GGBT.isNumber(id.substr(1)) && id.length > 8)) {\r\n                        id = id.substr(1);\r\n                    }\r\n                  }\r\n                  window.GGBT.injectapplet({\"material_id\": id});\r\n                 }else{\r\n                 document.getElementById('applet_options').style.display = \"flex\";\r\n                 window.GGBT.injectapplet({\"filename\": httpurl});}\r\n            });\r\n\r\n            $('#id_getvars').on('click', function(e) {\r\n                e.preventDefault();\r\n                window.GGBT.getrandvars();\r\n            });\r\n\r\n            if (this.parameters) {\r\n                window.applet1.inject(\"applet_container1\", \"preferHTML5\");\r\n            }\r\n\r\n            this.ggbf = document.getElementById('id_ggbtheader');\r\n            this.usefile = document.getElementById(\"id_usefile\");\r\n\r\n            if (this.ggbf === null) { // In this case we are editing a submission.\r\n                this.ggbf = document.getElementById('id_submissiontypes');\r\n                this.ggbcheckb = document.getElementById('id_assignsubmission_geogebra_enabled');\r\n                if (this.ggbcheckb !== null) {\r\n                    this.ggbcheckb.addEventListener('change', this.handleggbdisable, false);\r\n                }\r\n            }\r\n\r\n            if (this.ggbf !== null) {\r\n                this.ggbf.addEventListener('dragenter', this.handleDragEnter, false);\r\n                this.ggbf.addEventListener('dragover', this.handleDragOver, false);\r\n                this.ggbf.addEventListener('dragleave', this.handleDragEndLeave, false);\r\n                this.ggbf.addEventListener('dragend', this.handleDragEndLeave, false);\r\n                this.ggbf.addEventListener('drop', this.handleDrop, false);\r\n                this.usefile.addEventListener('change', this.handleusefile, false);\r\n            }\r\n\r\n            if (this.usefile.checked) {\r\n                document.getElementById('applet_options').style.display = \"block\";\r\n            } else {\r\n                document.getElementById('applet_options').style.display = \"flex\"; // ex none\r\n            }\r\n            this.initoptions();\r\n        },\r\n\r\n        callback: function(params) {\r\n        //alert(\"other filename\");\r\n        //debugcode();\r\n            var elementname = M.core_filepicker.instances[params['client_id']].options.elementname;\r\n            $('#id_' + elementname).val(params.url);\r\n            // inject applet to div layer\r\n            if(!params.file.startsWith('http')){\r\n            var id = (params.file).split(\".\")[0];\r\n            if (id.indexOf(\"m\") == 0) {\r\n                if (this.isNumber(id.substr(1)) || (!this.isNumber(id.substr(1)) && id.length > 8)) {\r\n                    id = id.substr(1);\r\n                }\r\n            }\r\n            this.injectapplet({\"material_id\": id});\r\n                 }else{window.GGBT.injectapplet({\"filename\": params.file});}\r\n        },\r\n\r\n\r\n        injectapplet: function(fileURL) {\r\n            if(this.hasOwnProperty('parameters')){\r\n             if(this.hasOwnProperty('ggbBase64')){delete this.parameters.ggbBase64;}\r\n            } else { this.parameters=null;}\r\n            this.parameters = {...this.parameters,  ...fileURL};\r\n            this.parameters.language = this.lang;\r\n            this.parameters.moodle = \"editingQuestionOrSubmission\";\r\n            // Since we only support HTML5 this should work for js-code in the applet to get executed (ggboninit).\r\n            this.parameters.useBrowserForJS = false;\r\n            //window.ggbAppletOnLoad = function (ggbAppletId) {}\r\n            document.getElementById('applet_container1').style.display = \"block\";\r\n\r\n                 //alert(\"hello custom ggb  4\");\r\n        //debugcode();\r\n         //           if (document.getElementById('id_isurlggb').checked) {\r\n                     //GGBApplet = document.getElementById('id_urlggb').value;\r\n          //          }\r\n            window.applet1 = new GGBApplet(this.parameters, true);\r\n                if(!(codebase===\"\")){window.applet1.setHTML5Codebase(codebase);}\r\n            // window.applet1.setHTML5Codebase(\"https://cdn.geogebra.org/apps/5.0.541.0/web3d\");\r\n\r\n            window.applet1.inject(\"applet_container1\", \"preferHTML5\");\r\n\r\n        },\r\n        getrandvars: function() {\r\n            var applet = document.ggbApplet;\r\n            if (typeof applet !== 'undefined') {\r\n                var objNumber = applet.getObjectNumber();\r\n                var randomizedvar = document.getElementById('id_randomizedvar');\r\n                var stringforrandomizedvars = \"\";\r\n                var i = 0;\r\n                for (var j = 0; j < objNumber; j++) {\r\n                   var strName = applet.getObjectName(j);\r\n                   if (strName == \"grade\"){\r\n                        var answer=$('#id_answer_' + i);\r\n                        if (answer !== null){answer.val(strName);this.update_feedback(answer);i++;}\r\n                    }\r\n                    if (applet.getObjectType(strName) == \"numeric\" && applet.isIndependent(strName)) {\r\n                        stringforrandomizedvars += strName + \",\";\r\n                    } else {\r\n                        //debugcode();\r\n                        /*\r\n                        if (applet.getObjectType(strName) == \"boolean\"){\r\n                        //alert(strName+\" boolean or number\");\r\n                            var answer = $('#id_answer_' + i);\r\n                            if (answer !== null && answer.length > 0) {\r\n                                if (!answer.val()) {\r\n                                    answer.val(strName);\r\n                                }\r\n                                this.update_feedback(answer);\r\n                                i++;\r\n                                //alert(strName);\r\n                                //\r\n                            }\r\n                        }\r\n                        */\r\n                    }\r\n                    randomizedvar.value = stringforrandomizedvars;\r\n                }\r\n            //if (applet.exists(\"grade\")) {\r\n            //    var answerscore = $('#id_answer_' + i);\r\n            //    answerscore.val(\"grade\");\r\n            //    this.update_feedback(answerscore);\r\n            // }\r\n            }\r\n        },\r\n\r\n        update_feedback: function(answernode) {\r\n            var id = answernode.attr('id').split(\"_\").pop();\r\n            //debugcode();\r\n            var varname = answernode.val();\r\n            if (!varname) {\r\n                // Should not happen, but make sure this function does not fail.\r\n                return;\r\n            }\r\n            var feedback = $('input[name=\"feedback[' + id + ']\"]');\r\n            var feedbackfromfile = $('#id_feedbackfromfile_' + id);\r\n            const parser = new DOMParser();\r\n            const xml = window.ggbApplet.getXML(varname);\r\n            if (!xml) {\r\n                // Should not happen, but make sure this function does not fail.\r\n                return;\r\n            }\r\n            const doc = parser.parseFromString(xml, \"text/xml\");\r\n            //alert(xml);\r\n            if (doc) {\r\n                var elem = doc.getElementsByTagName('caption');\r\n                //alert(\"retrieve \"+elem.toString());\r\n                var fbstring = '';\r\n                if (elem.length == 1) {\r\n                    fbstring = elem[0].getAttribute('val');\r\n                    feedback.val(fbstring);\r\n                    //alert(\"retrieve \"+fbstring);\r\n                } else if (elem.length > 1) {\r\n                    feedback.val('');\r\n                    //alert(\"retrieve fail length >1\");\r\n                    fbstring = '';\r\n                } else {\r\n                    //alert(\"retrieve fail 1\");\r\n                    feedback.val('');\r\n                    //this is rather an error condition but should be checked by the server\r\n                    fbstring = 'Caption not set or variable name wrong.';\r\n                }\r\n                feedbackfromfile.val(fbstring);\r\n            }\r\n        },\r\n\r\n        checkEnter: function(e) {\r\n            e = e || event;\r\n            var txtArea = /textarea/i.test((e.target || e.srcElement).tagName);\r\n            return txtArea || (e.keyCode || e.which || e.charCode || 0) !== 13;\r\n        },\r\n\r\n        initoptions: function() {\r\n            this.enable_right_click = document.getElementById('enableRightClick');\r\n            this.enable_label_drags = document.getElementById('enableLabelDrags');\r\n            this.enable_undo_redo = document.getElementById('enableUndoRedo');\r\n            this.show_reset_icon = document.getElementById('showResetIcon');\r\n            this.enable_shift_drag_zoom = document.getElementById('enableShiftDragZoom');\r\n            this.show_algebra_input = document.getElementById('showAlgebraInput');\r\n            this.show_menu_bar = document.getElementById('showMenuBar');\r\n            this.show_tool_bar = document.getElementById('showToolBar');\r\n\r\n            if (typeof this.parameters !== 'undefined') {\r\n                this.enable_right_click.checked = this.parameters.enableRightClick;\r\n                this.enable_label_drags.checked = this.parameters.enableLabelDrags;\r\n                this.enable_undo_redo.checked = this.parameters.enableUndoRedo;\r\n                this.show_reset_icon.checked = this.parameters.showResetIcon;\r\n                this.enable_shift_drag_zoom.checked = this.parameters.enableShiftDragZoom;\r\n                this.show_algebra_input.checked = this.parameters.showAlgebraInput;\r\n                this.show_menu_bar.checked = this.parameters.showMenuBar;\r\n                this.show_tool_bar.checked = this.parameters.showToolBar;\r\n                //debugcode();\r\n                //document.getElementById('showToolBar').checked=this.show_tool_bar.checked;\r\n\r\n            }\r\n\r\n            this.enable_right_click.addEventListener('change', this.handlesettingschanged, false);\r\n            this.enable_label_drags.addEventListener('change', this.handlesettingschanged, false);\r\n            this.enable_undo_redo.addEventListener('change', this.handlesettingschanged, false);\r\n            this.show_reset_icon.addEventListener('change', this.handlesettingschanged, false);\r\n            this.enable_shift_drag_zoom.addEventListener('change', this.handlesettingschanged, false);\r\n            this.show_algebra_input.addEventListener('change', this.handlesettingschanged, false);\r\n            this.show_menu_bar.addEventListener('change', this.handlesettingschanged, false);\r\n            this.show_tool_bar.addEventListener('change', this.handlesettingschanged, false);\r\n        },\r\n\r\n        handlesettingschanged: function(evt) {\r\ndebugcode();\r\n            window.GGBT.parameters[evt.target.id] = (evt.target.checked);\r\n            $('input[name=\"ggbparameters\"]').val(JSON.stringify(window.GGBT.parameters));\r\n            if (evt.target.id == \"showToolBar\" ||\r\n                evt.target.id == \"showMenuBar\" ||\r\n                evt.target.id == \"enableUndoRedo\" ||\r\n                evt.target.id == \"showAlgebraInput\") {\r\n                // alert(\"hello custom ggb 5\");\r\n        //debugcode();\r\n         //           if (document.getElementById('id_isurlggb').checked) {\r\n                     //GGBApplet = document.getElementById('id_urlggb').value;\r\n          //          }\r\n                window.applet1 = new GGBApplet(window.GGBT.parameters, true);\r\n                if(!(codebase===\"\")){window.applet1.setHTML5Codebase(codebase);}\r\n                // window.applet1.setHTML5Codebase(\"https://cdn.geogebra.org/apps/5.0.541.0/web3d\");\r\n                window.applet1.inject(\"applet_container1\", \"preferHTML5\");\r\n            } else {\r\n                window.ggbApplet[evt.target.id](evt.target.checked);\r\n            }\r\n        },\r\n\r\n        handleusefile: function() {\r\n            if (!window.GGBT.usefile.checked) {\r\n                document.getElementById('applet_container1').style.display = \"none\";\r\n                document.getElementById('applet_options').style.display = \"flex\"; //ex none\r\n            } else {\r\n                document.getElementById('id_ggbturl').value = \"\";\r\n                // document.getElementById('applet_container1').style.display = \"block\";\r\n            }\r\n        },\r\n\r\n        handleggbdisable: function() {\r\n            if (!window.GGBT.ggbcheckb.checked) {\r\n                document.getElementById('applet_container1').style.display = \"none\";\r\n                document.getElementById('applet_options').style.display = \"flex\"; //ex none\r\n                if (window.GGBT.usefile.checked) {\r\n                    window.GGBT.usefile.click();\r\n                }\r\n            } else {\r\n                document.getElementById('applet_container1').style.display = \"block\";\r\n            }\r\n        },\r\n\r\n        handleDragEnter: function() {\r\n            if (typeof (ggbcheckb) == \"undefined\" || window.GGBT.ggbcheckb.checked) {\r\n                window.GGBT.ggbf.classList.add('qtype-geogebra-hover');\r\n                document.getElementById('applet_container1').style.visibility = \"hidden\";\r\n            }\r\n        },\r\n\r\n        handleDragOver: function(e) {\r\n            if (typeof (window.GGBT.ggbcheckb) == \"undefined\" || window.GGBT.ggbcheckb.checked) {\r\n                if (e.preventDefault) {\r\n                    e.preventDefault();\r\n                }\r\n                window.GGBT.ggbf.classList.add('qtype-geogebra-hover');\r\n                document.getElementById('applet_container1').style.visibility = \"hidden\";\r\n                return false;\r\n            }\r\n        },\r\n\r\n        handleDragEndLeave: function() {\r\n            if (typeof (window.GGBT.ggbcheckb) == \"undefined\" || window.GGBT.ggbcheckb.checked) {\r\n                window.GGBT.ggbf.classList.remove('qtype-geogebra-hover');\r\n                document.getElementById('applet_container1').style.removeProperty(\"visibility\");\r\n            }\r\n        },\r\n        //handleStoreGGB: function() {\r\n            /*{\r\n            if (typeof (window.GGBT.ggbcheckb) == \"undefined\" || window.GGBT.ggbcheckb.checked) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                var file = e.dataTransfer.files[0];\r\n                window.GGBT.ggbf.classList.remove('qtype-geogebra-hover');\r\n                document.getElementById('applet_container1').style.removeProperty(\"visibility\");\r\n                document.getElementById('applet_container1').style.display = \"block\";\r\n                document.getElementById('applet_options').style.display = \"flex\";\r\n                document.getElementById('applet_container1').style.height = \"100%\";\r\n                //document.getElementById('applet_container1').style.width = \"100%\";\r\n\r\n                document.getElementById('id_ggbturl').value = \"\";\r\n                //this.usefile = document.getElementById(\"id_usefile\");\r\n                if (!window.GGBT.usefile.checked) {\r\n                    window.GGBT.usefile.click();\r\n                }\r\n                var reader = new FileReader();\r\n                reader.onload = function(event) {\r\n                    var base64 = event.target.result.replace(\"data:application/vnd.geogebra.file;base64,\", \"\");\r\n                */\r\n          //      debugcode();\r\n          //          var base64 = window.ggbApplet.getBase64() ;\r\n          //          window.GGBT.parameters = {\"ggbBase64\": base64};\r\n                    /*\r\n                    window.GGBT.parameters.enableRightClick = window.GGBT.enable_right_click.checked;\r\n                    window.GGBT.parameters.enableLabelDrags = window.GGBT.enable_label_drags.checked;\r\n                    window.GGBT.parameters.showResetIcon = window.GGBT.show_reset_icon.checked;\r\n                    window.GGBT.parameters.enableShiftDragZoom = window.GGBT.enable_shift_drag_zoom.checked;\r\n                    window.GGBT.parameters.showAlgebraInput = window.GGBT.show_algebra_input.checked;\r\n                    window.GGBT.parameters.showMenuBar = window.GGBT.show_menu_bar.checked;\r\n                    window.GGBT.parameters.showToolBar = window.GGBT.show_tool_bar.checked;\r\n                    window.GGBT.parameters.moodle = \"editingQuestionOrSubmission\";\r\n                    */\r\n                   // alert(\"hello custom ggb 2\");\r\n        //debugcode();\r\n         //           if (document.getElementById('id_isurlggb').checked) {\r\n                     //GGBApplet = document.getElementById('id_urlggb').value;\r\n          //          }\r\n          /*\r\n                    window.applet1 = new GGBApplet(window.GGBT.parameters, true);\r\n                if(!(codebase===\"\")){window.applet1.setHTML5Codebase(codebase);}\r\n                    // window.applet1.setHTML5Codebase(\"https://cdn.geogebra.org/apps/5.0.541.0/web3d\");\r\n                    window.applet1.inject(\"applet_container1\");\r\n                };\r\n\r\n                reader.readAsDataURL(file);\r\n            }*/\r\n        ///},\r\n\r\n        handleDrop: function(e) {\r\n            if (typeof (window.GGBT.ggbcheckb) == \"undefined\" || window.GGBT.ggbcheckb.checked) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                var file = e.dataTransfer.files[0];\r\n                window.GGBT.ggbf.classList.remove('qtype-geogebra-hover');\r\n                document.getElementById('applet_container1').style.removeProperty(\"visibility\");\r\n                document.getElementById('applet_container1').style.display = \"block\";\r\n                document.getElementById('applet_options').style.display = \"flex\";\r\n                document.getElementById('applet_container1').style.height = \"100%\";\r\n                //document.getElementById('applet_container1').style.width = \"100%\";\r\n\r\n                document.getElementById('id_ggbturl').value = \"\";\r\n                //this.usefile = document.getElementById(\"id_usefile\");\r\n                if (!window.GGBT.usefile.checked) {\r\n                    window.GGBT.usefile.click();\r\n                }\r\n                var reader = new FileReader();\r\n                reader.onload = function(event) {\r\n                    var base64 = event.target.result.replace(\"data:application/vnd.geogebra.file;base64,\", \"\");\r\n                    window.GGBT.parameters = {\"ggbBase64\": base64};\r\n                    window.GGBT.parameters.enableRightClick = window.GGBT.enable_right_click.checked;\r\n                    window.GGBT.parameters.enableLabelDrags = window.GGBT.enable_label_drags.checked;\r\n                    window.GGBT.parameters.showResetIcon = window.GGBT.show_reset_icon.checked;\r\n                    window.GGBT.parameters.enableUndoRedo = window.GGBT.enable_undo_redo.checked;\r\n                    window.GGBT.parameters.enableShiftDragZoom = window.GGBT.enable_shift_drag_zoom.checked;\r\n                    window.GGBT.parameters.showAlgebraInput = window.GGBT.show_algebra_input.checked;\r\n                    window.GGBT.parameters.showMenuBar = window.GGBT.show_menu_bar.checked;\r\n                    window.GGBT.parameters.showToolBar = window.GGBT.show_tool_bar.checked;\r\n                    window.GGBT.parameters.moodle = \"editingQuestionOrSubmission\";\r\n                   // alert(\"hello custom ggb 2\");\r\n        //debugcode();\r\n         //           if (document.getElementById('id_isurlggb').checked) {\r\n                     //GGBApplet = document.getElementById('id_urlggb').value;\r\n          //          }\r\n                    window.applet1 = new GGBApplet(window.GGBT.parameters, true);\r\n                if(!(codebase===\"\")){window.applet1.setHTML5Codebase(codebase);}\r\n                    // window.applet1.setHTML5Codebase(\"https://cdn.geogebra.org/apps/5.0.541.0/web3d\");\r\n                    window.applet1.inject(\"applet_container1\");\r\n                };\r\n\r\n                reader.readAsDataURL(file);\r\n            }\r\n        },\r\n\r\n        isNumber: function(n) {\r\n            return !isNaN(parseFloat(n)) && isFinite(n);\r\n        }\r\n    };\r\n});\r\n"],"names":["GGBAppletstr","codebase","document","getElementById","checked","GGBAppletcode","value","parts","split","rooturl","appl","base","define","$","GGBApplet","init","window","GGBT","this","ggbAppletOnLoad","debugcode","val","JSON","stringify","applet1","getParameters","getViews","getHTML5CodebaseVersion","ggbcheckb","applet","ggbApplet","getXML","getrandvars","i","answer","undefined","on","e","preventDefault","update_feedback","target","querySelector","onkeypress","checkEnter","usefile","style","display","ggbDataset","dataset","parameters","parse","err","alert","message","views","setHTML5Codebase","lang","httpurl","id","pop","startsWith","injectapplet","indexOf","isNumber","substr","length","inject","ggbf","addEventListener","handleggbdisable","handleDragEnter","handleDragOver","handleDragEndLeave","handleDrop","handleusefile","initoptions","callback","params","elementname","M","core_filepicker","instances","options","url","file","fileURL","hasOwnProperty","ggbBase64","language","moodle","useBrowserForJS","objNumber","getObjectNumber","randomizedvar","stringforrandomizedvars","j","strName","getObjectName","getObjectType","isIndependent","answernode","attr","varname","feedback","feedbackfromfile","parser","DOMParser","xml","doc","parseFromString","elem","getElementsByTagName","fbstring","getAttribute","event","test","srcElement","tagName","keyCode","which","charCode","enable_right_click","enable_label_drags","enable_undo_redo","show_reset_icon","enable_shift_drag_zoom","show_algebra_input","show_menu_bar","show_tool_bar","enableRightClick","enableLabelDrags","enableUndoRedo","showResetIcon","enableShiftDragZoom","showAlgebraInput","showMenuBar","showToolBar","handlesettingschanged","evt","click","classList","add","visibility","remove","removeProperty","stopPropagation","dataTransfer","files","height","reader","FileReader","onload","base64","result","replace","readAsDataURL","n","isNaN","parseFloat","isFinite"],"mappings":";;;;;;;;;GAaA,IAAIA,aACAC,SACW,GAA8C,OAA1CC,SAASC,eAAe,kBACnBD,SAASC,eAAe,eAAeC,QAAS,CACnDC,cAAgBH,SAASC,eAAe,aAAaG,UAChDC,MAAMF,cAAcG,MAAM,KAC9BC,QAAQF,MAAM,GACdG,KAAKH,MAAM,GACXI,KAAKJ,MAAM,GACfP,aAAeS,QAAQC,KACvBT,SAAWQ,QAAQE,UAEhBX,aAAe,6CACfC,SAAS,GAE7BW,6BAAO,CAAC,SAAUZ,eAAe,SAAUa,EAAGC,iBASpC,CAGHC,KAAM,cAGFC,OAAOC,KAAOC,KACdF,OAAOG,gBAAkB,cACzBC,YACIP,EAAE,+BAA+BQ,IAAIC,KAAKC,UAAUP,OAAOQ,QAAQC,kBACnEZ,EAAE,0BAA0BQ,IAAIC,KAAKC,UAAUP,OAAOQ,QAAQE,aAC9Db,EAAE,oCAAoCQ,IAAIL,OAAOQ,QAAQG,gCAE1B,IAAnBT,KAAKU,UAA2B,KACpCC,OAAS3B,SAAS4B,UACtBjB,EAAE,wBAAwBQ,IAAIQ,OAAOE,UAEjB7B,SAASC,eAAe,oBACzBG,OACfU,OAAOC,KAAKe,sBAGZC,EAAI,EACJC,OAASrB,EAAE,cAAgBoB,QACVE,IAAdD,OAAO,IACNA,OAAOb,QACPa,OAAOE,GAAG,gBAAgB,SAASC,GAC/BA,EAAEC,iBACFtB,OAAOC,KAAKsB,gBAAgB1B,EAAEwB,EAAEG,YAEpCxB,OAAOC,KAAKsB,gBAAgBL,SAEhCA,OAASrB,EAAE,iBAAkBoB,GAEjC/B,SAASuC,cAAc,WAAWC,WAAa1B,OAAOC,KAAK0B,WAE3D3B,OAAOC,KAAK2B,QAAQxC,UACpBF,SAASC,eAAe,qBAAqB0C,MAAMC,QAAU,QAC7D5C,SAASC,eAAe,kBAAkB0C,MAAMC,QAAU,cAI/BX,IAA/BtB,EAAE,sBAAsB,GAAkB,MACrCkC,WAAalC,EAAE,sBAAsB,GAAGmC,iBAEnCC,WAAa3B,KAAK4B,MAAMhC,KAAK6B,WAAWE,YAElD,MAAME,KACHC,MAAM,sBAAsBD,IAAIE,cAE9BJ,WAAa3B,KAAK4B,MAAMhC,KAAK6B,WAAWE,iBACxCK,MAAQpC,KAAK6B,WAAWO,MAErClC,YAKQJ,OAAOQ,QAAU,IAAIV,UAAUI,KAAK+B,YAAY,GAChC,KAAXhD,UACJe,OAAOQ,QAAQ+B,iBAAiBtD,eAE5BuD,KAAOtC,KAAK6B,WAAWS,KAKhC3C,EAAE,kBAAkBuB,GAAG,SAAS,SAASC,GACzCjB,YACIiB,EAAEC,qBACEmB,QAAU5C,EAAE,eAAeQ,MAC3BqC,GAAKD,QAAQjD,MAAM,KAAKmD,MACxBF,QAAQG,WAAW,SAQtB1D,SAASC,eAAe,kBAAkB0C,MAAMC,QAAU,OAC1D9B,OAAOC,KAAK4C,aAAa,UAAaJ,YARf,GAAnBC,GAAGI,QAAQ,OACR9C,OAAOC,KAAK8C,SAASL,GAAGM,OAAO,MAAShD,OAAOC,KAAK8C,SAASL,GAAGM,OAAO,KAAON,GAAGO,OAAS,KAC1FP,GAAKA,GAAGM,OAAO,IAGrBhD,OAAOC,KAAK4C,aAAa,aAAgBH,SAM/C7C,EAAE,eAAeuB,GAAG,SAAS,SAASC,GAClCA,EAAEC,iBACFtB,OAAOC,KAAKe,iBAGZd,KAAK+B,YACLjC,OAAOQ,QAAQ0C,OAAO,oBAAqB,oBAG1CC,KAAOjE,SAASC,eAAe,sBAC/ByC,QAAU1C,SAASC,eAAe,cAErB,OAAde,KAAKiD,YACAA,KAAOjE,SAASC,eAAe,2BAC/ByB,UAAY1B,SAASC,eAAe,wCAClB,OAAnBe,KAAKU,gBACAA,UAAUwC,iBAAiB,SAAUlD,KAAKmD,kBAAkB,IAIvD,OAAdnD,KAAKiD,YACAA,KAAKC,iBAAiB,YAAalD,KAAKoD,iBAAiB,QACzDH,KAAKC,iBAAiB,WAAYlD,KAAKqD,gBAAgB,QACvDJ,KAAKC,iBAAiB,YAAalD,KAAKsD,oBAAoB,QAC5DL,KAAKC,iBAAiB,UAAWlD,KAAKsD,oBAAoB,QAC1DL,KAAKC,iBAAiB,OAAQlD,KAAKuD,YAAY,QAC/C7B,QAAQwB,iBAAiB,SAAUlD,KAAKwD,eAAe,IAG5DxD,KAAK0B,QAAQxC,QACbF,SAASC,eAAe,kBAAkB0C,MAAMC,QAAU,QAE1D5C,SAASC,eAAe,kBAAkB0C,MAAMC,QAAU,YAEzD6B,eAGTC,SAAU,SAASC,YAGXC,YAAcC,EAAEC,gBAAgBC,UAAUJ,OAAM,WAAeK,QAAQJ,eAC3EjE,EAAE,OAASiE,aAAazD,IAAIwD,OAAOM,KAE/BN,OAAOO,KAAKxB,WAAW,QAQhB5C,OAAOC,KAAK4C,aAAa,UAAagB,OAAOO,WARrB,KAC/B1B,GAAMmB,OAAOO,KAAM5E,MAAM,KAAK,GACX,GAAnBkD,GAAGI,QAAQ,OACP5C,KAAK6C,SAASL,GAAGM,OAAO,MAAS9C,KAAK6C,SAASL,GAAGM,OAAO,KAAON,GAAGO,OAAS,KAC5EP,GAAKA,GAAGM,OAAO,SAGlBH,aAAa,aAAgBH,OAKtCG,aAAc,SAASwB,SAChBnE,KAAKoE,eAAe,cACnBpE,KAAKoE,eAAe,qBAAqBpE,KAAK+B,WAAWsC,eAC/CtC,WAAW,UACpBA,0CAAiB/B,KAAK+B,YAAgBoC,cACtCpC,WAAWuC,SAAWtE,KAAKsC,UAC3BP,WAAWwC,OAAS,mCAEpBxC,WAAWyC,iBAAkB,EAElCxF,SAASC,eAAe,qBAAqB0C,MAAMC,QAAU,QAO7D9B,OAAOQ,QAAU,IAAIV,UAAUI,KAAK+B,YAAY,GAC5B,KAAXhD,UAAgBe,OAAOQ,QAAQ+B,iBAAiBtD,UAGzDe,OAAOQ,QAAQ0C,OAAO,oBAAqB,gBAG/ClC,YAAa,eACLH,OAAS3B,SAAS4B,kBACA,IAAXD,eACH8D,UAAY9D,OAAO+D,kBACnBC,cAAgB3F,SAASC,eAAe,oBACxC2F,wBAA0B,GAC1B7D,EAAI,EACC8D,EAAI,EAAGA,EAAIJ,UAAWI,IAAK,KAC7BC,QAAUnE,OAAOoE,cAAcF,MACpB,SAAXC,QAAmB,KACd9D,OAAOrB,EAAE,cAAgBoB,GACd,OAAXC,SAAiBA,OAAOb,IAAI2E,cAAczD,gBAAgBL,QAAQD,KAErC,WAAjCJ,OAAOqE,cAAcF,UAAyBnE,OAAOsE,cAAcH,WACnEF,yBAA2BE,QAAU,KAmBzCH,cAAcvF,MAAQwF,0BAUlCvD,gBAAiB,SAAS6D,gBAClB1C,GAAK0C,WAAWC,KAAK,MAAM7F,MAAM,KAAKmD,MAEtC2C,QAAUF,WAAW/E,SACpBiF,aAIDC,SAAW1F,EAAE,wBAA0B6C,GAAK,OAC5C8C,iBAAmB3F,EAAE,wBAA0B6C,IAC7C+C,OAAS,IAAIC,UACbC,IAAM3F,OAAOc,UAAUC,OAAOuE,YAC/BK,SAICC,IAAMH,OAAOI,gBAAgBF,IAAK,eAEpCC,IAAK,KACDE,KAAOF,IAAIG,qBAAqB,WAEhCC,SAAW,GACI,GAAfF,KAAK7C,QACL+C,SAAWF,KAAK,GAAGG,aAAa,OAChCV,SAASlF,IAAI2F,WAENF,KAAK7C,OAAS,GACrBsC,SAASlF,IAAI,IAEb2F,SAAW,KAGXT,SAASlF,IAAI,IAEb2F,SAAW,2CAEfR,iBAAiBnF,IAAI2F,cAI7BrE,WAAY,SAASN,UACjBA,EAAIA,GAAK6E,MACK,YAAYC,MAAM9E,EAAEG,QAAUH,EAAE+E,YAAYC,UACM,MAA7ChF,EAAEiF,SAAWjF,EAAEkF,OAASlF,EAAEmF,UAAY,IAG7D7C,YAAa,gBACJ8C,mBAAqBvH,SAASC,eAAe,yBAC7CuH,mBAAqBxH,SAASC,eAAe,yBAC7CwH,iBAAmBzH,SAASC,eAAe,uBAC3CyH,gBAAkB1H,SAASC,eAAe,sBAC1C0H,uBAAyB3H,SAASC,eAAe,4BACjD2H,mBAAqB5H,SAASC,eAAe,yBAC7C4H,cAAgB7H,SAASC,eAAe,oBACxC6H,cAAgB9H,SAASC,eAAe,oBAEd,IAApBe,KAAK+B,kBACPwE,mBAAmBrH,QAAUc,KAAK+B,WAAWgF,sBAC7CP,mBAAmBtH,QAAUc,KAAK+B,WAAWiF,sBAC7CP,iBAAiBvH,QAAUc,KAAK+B,WAAWkF,oBAC3CP,gBAAgBxH,QAAUc,KAAK+B,WAAWmF,mBAC1CP,uBAAuBzH,QAAUc,KAAK+B,WAAWoF,yBACjDP,mBAAmB1H,QAAUc,KAAK+B,WAAWqF,sBAC7CP,cAAc3H,QAAUc,KAAK+B,WAAWsF,iBACxCP,cAAc5H,QAAUc,KAAK+B,WAAWuF,kBAM5Cf,mBAAmBrD,iBAAiB,SAAUlD,KAAKuH,uBAAuB,QAC1Ef,mBAAmBtD,iBAAiB,SAAUlD,KAAKuH,uBAAuB,QAC1Ed,iBAAiBvD,iBAAiB,SAAUlD,KAAKuH,uBAAuB,QACxEb,gBAAgBxD,iBAAiB,SAAUlD,KAAKuH,uBAAuB,QACvEZ,uBAAuBzD,iBAAiB,SAAUlD,KAAKuH,uBAAuB,QAC9EX,mBAAmB1D,iBAAiB,SAAUlD,KAAKuH,uBAAuB,QAC1EV,cAAc3D,iBAAiB,SAAUlD,KAAKuH,uBAAuB,QACrET,cAAc5D,iBAAiB,SAAUlD,KAAKuH,uBAAuB,IAG9EA,sBAAuB,SAASC,KACxCtH,YACYJ,OAAOC,KAAKgC,WAAWyF,IAAIlG,OAAOkB,IAAOgF,IAAIlG,OAAOpC,QACpDS,EAAE,+BAA+BQ,IAAIC,KAAKC,UAAUP,OAAOC,KAAKgC,aAC3C,eAAjByF,IAAIlG,OAAOkB,IACM,eAAjBgF,IAAIlG,OAAOkB,IACM,kBAAjBgF,IAAIlG,OAAOkB,IACM,oBAAjBgF,IAAIlG,OAAOkB,IAMX1C,OAAOQ,QAAU,IAAIV,UAAUE,OAAOC,KAAKgC,YAAY,GACvC,KAAXhD,UAAgBe,OAAOQ,QAAQ+B,iBAAiBtD,UAErDe,OAAOQ,QAAQ0C,OAAO,oBAAqB,gBAE3ClD,OAAOc,UAAU4G,IAAIlG,OAAOkB,IAAIgF,IAAIlG,OAAOpC,UAInDsE,cAAe,WACN1D,OAAOC,KAAK2B,QAAQxC,QAIrBF,SAASC,eAAe,cAAcG,MAAQ,IAH9CJ,SAASC,eAAe,qBAAqB0C,MAAMC,QAAU,OAC7D5C,SAASC,eAAe,kBAAkB0C,MAAMC,QAAU,SAOlEuB,iBAAkB,WACTrD,OAAOC,KAAKW,UAAUxB,QAOvBF,SAASC,eAAe,qBAAqB0C,MAAMC,QAAU,SAN7D5C,SAASC,eAAe,qBAAqB0C,MAAMC,QAAU,OAC7D5C,SAASC,eAAe,kBAAkB0C,MAAMC,QAAU,OACtD9B,OAAOC,KAAK2B,QAAQxC,SACpBY,OAAOC,KAAK2B,QAAQ+F,UAOhCrE,gBAAiB,YACa,oBAAd1C,WAA6BZ,OAAOC,KAAKW,UAAUxB,WAC3DY,OAAOC,KAAKkD,KAAKyE,UAAUC,IAAI,wBAC/B3I,SAASC,eAAe,qBAAqB0C,MAAMiG,WAAa,WAIxEvE,eAAgB,SAASlC,WACiB,IAA1BrB,OAAOC,KAAKW,WAA6BZ,OAAOC,KAAKW,UAAUxB,eACnEiC,EAAEC,gBACFD,EAAEC,iBAENtB,OAAOC,KAAKkD,KAAKyE,UAAUC,IAAI,wBAC/B3I,SAASC,eAAe,qBAAqB0C,MAAMiG,WAAa,UACzD,GAIftE,mBAAoB,iBACsB,IAA1BxD,OAAOC,KAAKW,WAA6BZ,OAAOC,KAAKW,UAAUxB,WACvEY,OAAOC,KAAKkD,KAAKyE,UAAUG,OAAO,wBAClC7I,SAASC,eAAe,qBAAqB0C,MAAMmG,eAAe,gBAsD1EvE,WAAY,SAASpC,WACqB,IAA1BrB,OAAOC,KAAKW,WAA6BZ,OAAOC,KAAKW,UAAUxB,QAAS,CAChFiC,EAAEC,iBACFD,EAAE4G,sBACE7D,KAAO/C,EAAE6G,aAAaC,MAAM,GAChCnI,OAAOC,KAAKkD,KAAKyE,UAAUG,OAAO,wBAClC7I,SAASC,eAAe,qBAAqB0C,MAAMmG,eAAe,cAClE9I,SAASC,eAAe,qBAAqB0C,MAAMC,QAAU,QAC7D5C,SAASC,eAAe,kBAAkB0C,MAAMC,QAAU,OAC1D5C,SAASC,eAAe,qBAAqB0C,MAAMuG,OAAS,OAG5DlJ,SAASC,eAAe,cAAcG,MAAQ,GAEzCU,OAAOC,KAAK2B,QAAQxC,SACrBY,OAAOC,KAAK2B,QAAQ+F,YAEpBU,OAAS,IAAIC,WACjBD,OAAOE,OAAS,SAASrC,WACjBsC,OAAStC,MAAM1E,OAAOiH,OAAOC,QAAQ,6CAA8C,IACvF1I,OAAOC,KAAKgC,WAAa,WAAcuG,QACvCxI,OAAOC,KAAKgC,WAAWgF,iBAAmBjH,OAAOC,KAAKwG,mBAAmBrH,QACzEY,OAAOC,KAAKgC,WAAWiF,iBAAmBlH,OAAOC,KAAKyG,mBAAmBtH,QACzEY,OAAOC,KAAKgC,WAAWmF,cAAgBpH,OAAOC,KAAK2G,gBAAgBxH,QACnEY,OAAOC,KAAKgC,WAAWkF,eAAiBnH,OAAOC,KAAK0G,iBAAiBvH,QACrEY,OAAOC,KAAKgC,WAAWoF,oBAAsBrH,OAAOC,KAAK4G,uBAAuBzH,QAChFY,OAAOC,KAAKgC,WAAWqF,iBAAmBtH,OAAOC,KAAK6G,mBAAmB1H,QACzEY,OAAOC,KAAKgC,WAAWsF,YAAcvH,OAAOC,KAAK8G,cAAc3H,QAC/DY,OAAOC,KAAKgC,WAAWuF,YAAcxH,OAAOC,KAAK+G,cAAc5H,QAC/DY,OAAOC,KAAKgC,WAAWwC,OAAS,8BAMhCzE,OAAOQ,QAAU,IAAIV,UAAUE,OAAOC,KAAKgC,YAAY,GAC3C,KAAXhD,UAAgBe,OAAOQ,QAAQ+B,iBAAiBtD,UAEjDe,OAAOQ,QAAQ0C,OAAO,sBAG1BmF,OAAOM,cAAcvE,QAI7BrB,SAAU,SAAS6F,UACPC,MAAMC,WAAWF,KAAOG,SAASH,IAGpD"}