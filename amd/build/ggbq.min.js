function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}
/**
 * Javascript Controller to embed GGBApplet
 *
 * STUDENT VIEW
 *
 * This class provides all the functionality for the new assign module.
 *
 * @author         Christoph Stadlbauer <christoph.stadlbauer@geogebra.org>
 * @copyright  (c) International GeoGebra Institute 2018
 * @license        http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */(arr)||function(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}define("qtype_geogebra/ggbq",["jquery","https://www.geogebra.org/apps/deployggb.js"],(function($,GGBApplet){var resizeTimeout,scalingContainers={},resizeScalingContainer=function(){clearTimeout(resizeTimeout),resizeTimeout=setTimeout((function(){return Object.values(scalingContainers).forEach((function(containerClass){var scalingContainer=document.getElementsByClassName(containerClass)[0],formulationDivStyle=window.getComputedStyle(scalingContainer.querySelector(".qtext").parentElement.parentElement);scalingContainer.style.width=parseInt(formulationDivStyle.width)-parseInt(formulationDivStyle.paddingLeft)-parseInt(formulationDivStyle.paddingRight)+"px"}))}),250)};return{b64input:[],ggbBase64:[],xmlinput:[],ggbxml:[],currentvals:[],answerinput:[],responsevars:[],exerciseresultinput:[],qdiv:[],ggbDataset:[],init:function(appletParametersID){window.GGBQ=this;var ggbDataset=document.getElementById(appletParametersID).dataset,slot=ggbDataset.slot;scalingContainers[slot]=ggbDataset.scalingcontainerclass,window.ggbAppletOnLoad=function(ggbAppletId){if(-1!=ggbAppletId){document.querySelector("article").onkeydown=this.checkEnter;var id=ggbAppletId.substring(9),ggbApplet=window[ggbAppletId],curvals=JSON.parse(window.GGBQ.currentvals[id]);for(var label in curvals)ggbApplet.setValue(label,curvals[label]);if(resizeScalingContainer(),window.removeEventListener("resize",resizeScalingContainer),window.addEventListener("resize",resizeScalingContainer),window.GGBQ.b64input[id].val(ggbApplet.getBase64()),window.GGBQ.xmlinput[id].val(ggbApplet.getXML()),window.GGBQ.qdiv[id].style.visibility="visible",""==window.GGBQ.answerinput[id].val()){var responsestring="";window.GGBQ.responsevars[id].forEach((function(responsevar){ggbApplet.isDefined(responsevar)?responsestring+=ggbApplet.getValue(responsevar):responsestring+=0})),window.GGBQ.answerinput[id].val(responsestring)}}},this.b64input[slot]=$(document.getElementById(ggbDataset.b64input)),this.ggbBase64[slot]=this.b64input[slot].val(),this.xmlinput[slot]=$(document.getElementById(ggbDataset.xmlinput)),this.ggbxml[slot]=this.xmlinput[slot].val(),this.qdiv[slot]=$("#q"+slot+" .qtext")[0];var parameters=JSON.parse(ggbDataset.parameters);if(""!=this.ggbBase64[slot]&&(parameters.ggbBase64=this.ggbBase64[slot]),ggbDataset.forcedimensions&&"0"!==ggbDataset.forcedimensions){parameters.width=ggbDataset.width,parameters.height=ggbDataset.height;var scalingContainer=document.getElementsByClassName(scalingContainers[slot])[0];scalingContainer&&(scalingContainer.style.overflowX="auto",scalingContainer.style.overflowY="hidden")}else parameters.scaleContainerClass=scalingContainers[slot],parameters.autoHeight=!0;this.ggbDatasetVars=JSON.parse(ggbDataset.vars),parameters.language=ggbDataset.lang,parameters.moodle="takingQuiz",delete parameters.material_id,parameters.id="ggbApplet"+slot;var views=JSON.parse(ggbDataset.views);new GGBApplet(parameters,views,ggbDataset.html5NoWebSimple).inject(ggbDataset.div,"preferHTML5"),$("#responseform").on("submit",this.getBase64andCheck),$(document.getElementById(ggbDataset.div)).on("mouseleave",this.getBase64andCheck),this.currentvals[slot]=ggbDataset.vars,this.answerinput[slot]=$(document.getElementById(ggbDataset.answerinput)),this.exerciseresultinput[slot]=$(document.getElementById(ggbDataset.exerciseresultinput)),this.responsevars[slot]=JSON.parse(ggbDataset.responsevars)},checkEnter:function(e){return e=e||event,/textarea/i.test((e.target||e.srcElement).tagName)||13!==(e.keyCode||e.which||e.charCode||0)},getBase64andCheck:function(){for(var i=0;i<window.GGBQ.answerinput.length;i++){var ggbApplet=window["ggbApplet"+i];if(void 0!==ggbApplet){window.GGBQ.b64input[i].val(ggbApplet.getBase64()),window.GGBQ.xmlinput[i].val(ggbApplet.getXML());for(var _i=0,_Object$entries=Object.entries(window.GGBQ.ggbDatasetVars);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];ggbApplet.evalCommand("".concat(key,"=").concat(value))}for(var responsestring="",j=0;j<window.GGBQ.responsevars[i].length;j++)ggbApplet.isDefined(window.GGBQ.responsevars[i][j])?responsestring+=ggbApplet.getValue(window.GGBQ.responsevars[i][j]):responsestring+=0;window.GGBQ.answerinput[i].val(responsestring)}}}}}));

//# sourceMappingURL=ggbq.min.js.map